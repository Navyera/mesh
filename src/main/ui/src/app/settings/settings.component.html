<div class="container">
  <h1>Settings</h1>

        <!-- User Details Form  -->
        <ngb-tabset>
          <ngb-tab title="User details">
            <ng-template ngbTabContent>
              <form (ngSubmit)="userDetailsSubmit()" #userDetailsForm="ngForm">
                <div class="form-group">
                  <label for="firstName">First Name</label>
                  <input type="text" class="form-control" id="firstName" required
                         pattern="[a-zA-Z]*"
                         [(ngModel)]="model.firstName" name="firstName"
                         #firstName="ngModel">

                  <div *ngIf="firstName.dirty && firstName.errors?.required"
                       class="alert alert-danger">
                    First name is required
                  </div>

                </div>

                <div class="form-group">
                  <label for="lastName">Last Name</label>
                  <input type="text" class="form-control" id="lastName" required
                         pattern="[a-zA-Z]*"
                         [(ngModel)]="model.lastName" name="lastName"
                         #lastName="ngModel">

                  <div *ngIf="lastName.dirty && lastName.errors?.required"
                       class="alert alert-danger">
                    Last name is required
                  </div>

                </div>

                <div class="form-group">
                  <label for="phone">Phone</label>
                  <input type="tel" class="form-control" id="phone" required
                         pattern="[0-9]{1,15}"
                         [(ngModel)]="model.phone" name="phone"
                         #phone="ngModel">

                  <div *ngIf="phone.dirty && phone.errors?.required"
                       class="alert alert-danger">
                    Phone is required
                  </div>
                </div>

                <div class="form-group">
                  <button type="submit" class="btn btn-primary"
                          [disabled]="!userDetailsForm.valid || !userDetailsForm.dirty">Save Changes</button>

                  <button type="button" (click)="cancel()" class="btn btn-link">Cancel</button>
                </div>
              </form>
            </ng-template>
          </ngb-tab>

          <ngb-tab title="Email">
            <ng-template ngbTabContent>
              <form (ngSubmit)="emailSubmit()" #emailForm="ngForm">
                <div class="form-group">
                  <label for="email">E-mail</label>
                  <input type="email" class="form-control" id="email" required email
                         [(ngModel)]="model.email" name="email"
                         #email="ngModel">

                  <div *ngIf="email.dirty && email.errors?.required"
                       class="alert alert-danger">
                    Email is required
                  </div>
                </div>

                <div class="form-group">
                  <button type="submit" class="btn btn-primary"
                          [disabled]="!emailForm.valid || !emailForm.dirty">Save Changes</button>

                  <button type="button" (click)="cancel()" class="btn btn-link">Cancel</button>
                </div>
              </form>
            </ng-template>
          </ngb-tab>

          <ngb-tab title="Password">
            <ng-template ngbTabContent>
              <form (ngSubmit)="passwordSubmit()" #passwordForm="ngForm">
                <div class="form-group">
                  <label for="oldPassword">Old Password</label>
                  <input type="password" class="form-control" id="oldPassword" required
                         [(ngModel)]="model.oldPassword" name="oldPassword"
                         #oldPassword="ngModel">

                  <div *ngIf="oldPassword.dirty && oldPassword.errors?.required"
                       class="alert alert-danger">
                    Old password is required
                  </div>
                </div>


                <div ngModelGroup="passwords" id="passwords" #passwords="ngModelGroup"
                     appCheckPassword password="newPassword" confirmPassword="confirmNewPassword">

                  <div class="form-group">
                    <label for="newPassword">New Password</label>
                    <input type="password" class="form-control" id="newPassword" required
                           [(ngModel)]="model.newPassword" name="newPassword"
                           #newPassword="ngModel">

                    <div *ngIf="newPassword.dirty && newPassword.errors?.required"
                         class="alert alert-danger">
                      Please fill in your new password
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="confirmNewPassword">Retype New Password</label>
                    <input type="password" class="form-control" id="confirmNewPassword" required
                           [(ngModel)]="model.confirmNewPassword" name="confirmNewPassword"
                           #confirmNewPassword="ngModel">

                    <div *ngIf="confirmNewPassword.dirty && confirmNewPassword.errors?.required
                              &&(newPassword.dirty || newPassword.touched)"
                         class="alert alert-danger">
                      Please confirm your new password
                    </div>

                    <div *ngIf="passwords.errors?.passwordCheck &&
                                (confirmNewPassword.dirty || confirmNewPassword.touched)"
                         class="alert alert-danger" >
                      Passwords do not match
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <button type="submit" class="btn btn-primary"
                          [disabled]="!passwordForm.valid"> Submit </button>

                  <button type="button" (click)="cancel()" class="btn btn-link">Cancel</button>
                </div>
              </form>
            </ng-template>
          </ngb-tab>

          <ngb-tab title="Profile picture">
            <ng-template ngbTabContent>
              <img id="img-preview" [src]="imgPreview || '../../assets/images/profile-placeholder.png'" alt="your image" />
              <div class="form-group">
                <label for="picture">Profile Picture</label> <br>
                <input
                  style="display: none" id="picture"
                  type="file" (change)="onFileChanged($event)"
                  #fileInput>
                <button (click)="fileInput.click()" type="button" class="btn btn-secondary">Select File</button>
              </div>

              <button type="submit" class="btn btn-primary" (click)="pictureSubmit()"> Upload </button>

              <button type="button" class="btn btn-link" (click)="cancel()" >Cancel</button>
            </ng-template>
          </ngb-tab>
        </ngb-tabset>
</div>

